<!DOCTYPE html>
<html>
<body>
<style>
    body{
        font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
        background-color:wheat;
        text-align: center;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        border: 1px solid black;
        padding: 8px;
        text-align: left;
        background-color: lightgray;
    }

    th {
        background-color: greenyellow
    }
    h1{
        text-align: center;
        color: lightslategray;
    }
    
</style>


    <h1>Student Signups</h1>

    <a href="index.html">Back to Signups</a>
    <br>
    <br>
    <label for="PreferredOrganization/Club">Select Club:</label>
    <select name="PreferredOrganization/Club" id="PreferredOrganization/Club" oninput="filterTable()">
        <option value="All">--Selection--</option>
        <option value="All">All</option>
        <option value="Labuyo">Labuyo</option>
        <option value="Pallastro">Pallastro</option>
        <option value="Alinati">Alinati</option>
        <option value="Invictus">Invictus</option>
        <option value="Exposure">Exposure</option>
        <option value="Ellipsis">Ellipsis</option>
        <option value="Bravura">Bravura</option>
    </select>
    <br>
    <br>
    <h4>Total Signup: <span id="totalSignups"></span></h4>
      <table>
    <thead>
        <tr>
            <th>Student ID</th>
            <th>Full Name</th>
            <th>Birthday</th>
            <th>Email Address</th>
            <th>Mobile Phone</th>
            <th>Grade Level</th>
            <th>Intern/Extern</th>
            <th>Preferred Club</th>
        </tr>
    </thead>
    <tbody id="table"></tbody>
    <tbody id="noSignups">
        <tr>
            <td colspan="9">No sign ups yet</td>
        </tr>
    </tbody>
    </table>

    <script>

    function loadDATA(){
        return JSON.parse(localStorage.getItem("data")) || [];
    }



    function render(){
        const data = loadDATA();
        const table = document.getElementById("table");
        if(data.length == 0){
            table.innerHTML='<tr><td colspan="9">No data available</td></tr>';
            document.getElementById("totalSignups").textContent = 0;
            document.getElementById(noSignups).style.display = "";
            return;
        }
        table.innerHTML = data.map(item => createRow(item)).join("");
        document.getElementById("noSignups").style.display = "none";

        filterTable();
    }

    function createRow(item){
        return `
            <tr>
                <td>${escapeHtml(item.StudentID)}</td>
                <td>${escapeHtml(item.FullName)}</td>
                <td>${escapeHtml(item.Birthday)}</td>
                <td>${escapeHtml(item.EmailAdress)}</td>
                <td>${escapeHtml(item.MobilePhone)}</td>
                <td>${escapeHtml(item.GradeLevel)}</td>
                <td>${escapeHtml(item.InternExtern)}</td>
                <td>${escapeHtml(item.PreferredClub)}</td>
            </tr>
            `;
    }

    function filterTable() {
        const select = document.getElementById("PreferredOrganization/Club");
        const table = document.getElementById("table");
        const rows = table.getElementsByTagName("tr");
        filter = select.value;
        let visibleCount = 0;

        for(let row of rows){
            cells = row.getElementsByTagName("td");
            clubs = cells[7] || null;
            if (clubs) {
                if (filter == "All" ||clubs.textContent === filter || filter === "") {
                    row.style.display = "";
                    visibleCount++;
                } else {
                    row.style.display = "none";
                }
            }
        }

        const noMatch = document.getElementById("noSignups");
        if(visibleCount === 0){
            noMatch.style.display = "";
        }
        else{ 
           noMatch.style.display = "none";
        }
        document.getElementById("totalSignups").textContent = visibleCount;
    }

    function escapeHtml(n){
        let str = String(n);
        let escapedStr = "";
        for(let i = 0; i < str.length; i++){
            let c = str.charAt(i);
            
             if (c === '&') {
          escapedStr += '&amp;';
        } else if (c === '<') {
          escapedStr += '&lt;';
        } else if (c === '>') {
          escapedStr += '&gt;';
        } else if (c === '"') {     
          escapedStr += '&quot;';
        } else if (c === "'") {
          escapedStr += '&#39;';
        } else {
          escapedStr += c;
        }
      }
      return escapedStr;
    }


render();

</script>

   

   


</body>
</html>